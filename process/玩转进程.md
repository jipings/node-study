
## 玩转进程

单线程，状态单一，没有多线程的情况下没有线程锁，线程同步问题，操作系统在调度时也因为较少的上下文的切换，可以很好的提高CPU的使用率。

### 如何充分利用多核CPU服务器？

Node 执行在单线程上，一旦单线程上抛出的异常没有被捕获，将会引起整个进程的崩溃。

### 如何保证进程的健壮性和稳定性？

### Master-Worker

主进程和工作进程，这是典型的分布式架构中用于并行处理业务的模式，具备较好的可伸缩性和稳定性。主进程不负责具体的业务处理，而是负责调度或管理工作进程，它是趋向稳定的。工作进程负责具体的业务处理，因为业务的多样性，所以工作进程的稳定性值得开发者关注。

通过fork() 复制的进程都是一个独立的进程，这个进程中有着独立而全新额V8实例。它需要至少30ms的启动时间和至少10mb的内存。尽管Node提供了fork()供我们复制进程使每个cpu内核都使用上，但是依然要切记fork()进程是昂贵的。Node通过事件驱动方式在单线程上解决了大并发的问题

### 如何创建子进程
child_process 模块给予Node可以随意创建子进程（child_process）的能力。它提供了4个方法

* spawn() : 启动一个子进程来执行命令
* exec() ：启动一个子进程来执行命令，与spawn() 不同的是其接口不同，它有一个回调函数获取子进程的状态。
* execFile() : 启动一个子进程来执行可执行文件
* fork(): 与 spawn() 类似，不同点在于它创建Node的子进程只需要执行的JavaScript文件模块即可。

### 进程间通信

主线程与工作线程之间的通信通过onmessage() 和 postMessage() 进行通信，子进程对象则由send() 方法实现主进程向子进程发送数据，message 事件实现收听子进程发来的数据，与API在一定程度上相似。通过消息传递内容，而不是共享或者直接操作相关资源，这是较为轻量和无依赖的做法。

### 进程间通信原理
* IPC的全称是 `Inter-Process Communication`, 即进程间通信。进程间通信的目的是为了让不同的进程能够互相访问资源并进行协调工作。实际进程间通信的技术有很多，如命名管道、匿名管道、socket、信号量、共享内存、消息队列、Domain Socket。
Node中实现IPC通道的是管道（pipe）技术。
* 句柄传递  句柄是一种可以用来标识资源的引用，它的内部包含了指向对象的文件描述符。比如句柄可以用来标识一个服务器端socket对象，一个客户端socket对象、一个UDP套接字。
